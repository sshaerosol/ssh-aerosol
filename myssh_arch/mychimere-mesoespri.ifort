#!/bin/bash

#---------------------------------------------------------------------------------
#	Architecture file for compiling and running CHIMERE	
#	Specify path to libraries, compilers and utilities 
#---------------------------------------------------------------------------------

## Modules
module purge
#module load intel/15.0.6.233
module load intel/19.0.8.324
module load PrgEnv/mpi
#module load openmpi/1.6.5-ifort 
#module load netcdf4/4.4.1.1-parallel-ifort
#module load hdf5/1.8.18-parallel-ifort
module load blitz/1.0.1 jasper/2.0.16

#---------------------------------------------------------------------------------
# 	Compilers
#---------------------------------------------------------------------------------
export my_compilerF90=ifort		# Path to Fortran 90 compiler
export my_compilerC=icc			# Path to C compiler
export my_compilerCpp=icpc			# Path to C++ compiler


#---------------------------------------------------------------------------------
# 	MPI - parallel execution of chimere
#---------------------------------------------------------------------------------
export  my_mpiframe=openmpi  		                            	# implementaion of MPI norm [ ompi / ccrt ] TO REMOVE
export  my_mpibin=/net/nfs/tools/meso-sl6/openmpi/4.0.5-intel-19.0.8.324/bin/    			# Path to MPI binary directory
export  my_mpirun=${my_mpibin}/mpirun    		# Path to mpirun to execute parallel job in MPI
export  my_mpif90=${my_mpibin}/mpif90    		# Wrapper to my_compilerF90 to link with MPI library
export  my_mpicc=${my_mpibin}/mpicc     		# Wrapper to my_compilerC to link with MPI library
export  my_mpilib=${my_mpibin}/../lib    			# Path to MPI libraries directory
export  my_mpiinc=${my_mpibin}/../include    		# Path to MPI include files directory


#---------------------------------------------------------------------------------
# 	HDF5  - parallel version	
#---------------------------------------------------------------------------------
dirhdf=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/hdf5-1.10.7-zz2eqw53dphfhi75onkjygyoizopmr7r/
export my_hdflib=${dirhdf}/lib		# Path to HDF5 parallel library directory
export my_hdfinc=${dirhdf}/include	# Path to HDF5 parallel include files directory


#---------------------------------------------------------------------------------
# 	NETCDF-C  - link with HDF5 parallel 
#---------------------------------------------------------------------------------
dirnetcdfC=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/netcdf-c-4.7.4-afzai3czsuiokqfwgzw6hlt44zsmh3a4/
export my_netcdfCbin=${dirnetcdfC}/bin 		# Path to NETCDF-C (linked with HDF5 parallel) binaries directory 
export my_netcdfClib=${dirnetcdfC}/lib		# Path to NETCDF-C (linked with HDF5 parallel) library directory


#---------------------------------------------------------------------------------
# 	NETCDF-Fortran  - link with HDF5 parallel and NETCDF-C
#---------------------------------------------------------------------------------
dirnetcdfF90=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/netcdf-fortran-4.5.3-25fnjq7g67nj6hyj74o3g6xvbp3ovowx/
export my_netcdfF90bin=${dirnetcdfF90}/bin      # PATH to NETCDF-Fortran (linked with HDF5 parallel and NETCDF-C) binaries  directory
export my_netcdfF90lib=${dirnetcdfF90}/lib		# Path to NETCDF-Fortran (linked with HDF5 parallel and NETCDF-C) library  directory
export my_netcdfF90inc=${dirnetcdfF90}/include	# Path to NETCDF-Fortran (linked with HDF5 parallel and NETCDF-C) include files  directory


#---------------------------------------------------------------------------------
# 	GRIB  - link with jasper 
#---------------------------------------------------------------------------------
dirgrib=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/eccodes-2.20.0-kiyd2t5g5ajix4g446d5i3djxa4app2k/
export my_griblib=${dirgrib}/lib64     	# Path to GRIB library directory
export my_gribinc=${dirgrib}/include 	# Path to GRIB include files directory
dirjasper=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/jasper-2.0.16-aogbgvyh6bdpb3jwlcy2pjero2pvsmne
export my_jasperlib=${dirjasper}/lib64 		                	                # Path to JASPER library directory
export my_jasperinc=${dirjasper}/include/jasper			                        # Path to JASPER include files directory


#---------------------------------------------------------------------------------
# 	BLITZ
#---------------------------------------------------------------------------------
#export my_blitzinc=/home/rpennel/local/blitz/include/blitz-0.10		 # Path to BLITZ include files 
export my_blitzinc=/net/nfs/tools/PrgEnv/linux-scientific6-x86_64/intel-19.0.8.324/blitz-1.0.1-ywhjwqpjuviollcmqtloxgbiwj6zc4qf/include/		 # Path to BLITZ include files 


#---------------------------------------------------------------------------------
# 	Utilities	
#---------------------------------------------------------------------------------
export my_make=make 	                                        	# Path to make 
export my_awk=awk		                                        	# Path to awk
export my_python3=/opt/anaconda3/bin/python3
export my_ncdump=${dirnetcdfC}/bin/ncdump		# Path to ncdump


#---------------------------------------------------------------------------------
# 	Makefile header needed to compile CHIMERE and WRF 
#	     - with this architecture configuration - 	
#---------------------------------------------------------------------------------
export my_hdr=Makefile.hdr.ifort-64-ompi   		            	# Makefile header to compile CHIMERE in makefiles.hdr directory
export configure_wrf_file_name=configure.wrf.ifort             	# Makefile header to compile WRF in config_wrf directory
export configure_wps_file_name=configure_ifort.wps          	# Makefile header to compile WPS in config_wps directory


#---------------------------------------------------------------------------------
#	Export of Shared Library to be available at run time 	
#---------------------------------------------------------------------------------
export LD_LIBRARY_PATH=${my_hdflib}:${my_netcdfF90lib}:${my_netcdfClib}:${my_griblib}:${my_mpilib}:${my_mpilib}/openmpi:$LD_LIBRARY_PATH
export LIBRARY_PATH=/net/nfs/tools/intel/2019/compilers_and_libraries_2019.6.324/linux/compiler/lib/intel64_lin/:$LIBRARY_PATH


#---------------------------------------------------------------------------------
# 	SSH-aerosol	
#---------------------------------------------------------------------------------
export my_ssh=${chimere_root}/ssh-aerosol/src/
